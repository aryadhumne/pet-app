{% extends "base.html" %}
{% block content %}

<style>
    .diet-card {
        width: 280px;                     /* Same size as Sahiwal container */
        margin: 20px auto;
        background: #ffffff;
        padding: 20px;
        border-radius: 15px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
    h2 {
        text-align: center;
        margin-bottom: 20px;
        font-weight: 700;
    }
    label {
        font-weight: 600;
        margin-top: 10px;
    }
</style>

<div class="diet-card">
    <h2>Generate Diet Plan</h2>

    <div class="row g-3">

        <div class="col-12">
            <label>Pet Name</label>
            <input type="text" class="form-control" id="petName">
        </div>

        <div class="col-12">
            <label>Species</label>
            <select id="petSpecies" class="form-control">
                <option value="">Select Species</option>

                <optgroup label="ðŸ¾ Pet Animals">
                    <option>Dog</option>
                    <option>Cat</option>
                    <option>Birds</option>
                    <option>Rabbit</option>
                    <option>Fish</option>
                    <option>Hamster</option>
                </optgroup>

                <optgroup label="ðŸ„ Agripet Animals">
                    <option>Cow</option>
                    <option>Buffalo</option>
                    <option>Ox</option>
                    <option>Camel</option>
                    <option>Horse</option>
                    <option>Donkey</option>
                    <option>Goat</option>
                    <option>Sheep</option>
                    <option>Pig</option>
                    <option>Chicken</option>
                    <option>Rooster</option>
                </optgroup>

            </select>
        </div>

        <div class="col-12">
            <label>Breed / Type</label>
            <input type="text" class="form-control" id="petBreed">
        </div>

        <div class="col-12">
            <label>Age (Years)</label>
            <input type="number" class="form-control" id="petAgeYears">
        </div>

        <div class="col-12">
            <label>Age (Months)</label>
            <input type="number" class="form-control" id="petAgeMonths">
        </div>

        <div class="col-12">
            <label>Weight (kg)</label>
            <input type="number" class="form-control" id="petWeight">
        </div>

        <div class="col-12">
            <label>Health Issues</label>
            <input type="text" class="form-control" id="petHealthIssue">
        </div>
    </div>

    <button class="btn btn-success w-100 mt-3" id="generateDiet">Generate Diet</button>

    <div class="mt-4">
        <h5>Diet Result</h5>
        
        <label for="dietMorning">Morning</label>
        <input class="form-control mt-2" id="dietMorning" placeholder="Morning">
        
        <label for="dietMorning">Afternoon</label>
        <input class="form-control mt-2" id="dietAfternoon" placeholder="Afternoon">
        
        <label for="dietMorning">Eveing</label>
        <input class="form-control mt-2" id="dietEvening" placeholder="Evening">
        
        <label for="dietMorning">Water Intake</label>
        <input class="form-control mt-2" id="dietWater" placeholder="Water Intake">
        
        <label for="dietMorning">Notes</label>
        <textarea class="form-control mt-2" id="dietNotes" placeholder="Notes"></textarea>
    </div>
</div>

<script>
document.getElementById("generateDiet").onclick = async () => {
    const petData = {
        name: petName.value,
        breed: petBreed.value,
        species: petSpecies.value,
        ageYears: petAgeYears.value,
        ageMonths: petAgeMonths.value,
        weight: petWeight.value,
        healthIssue: petHealthIssue.value
    };

    try {
        const res = await fetch("/generate_diet_plan", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(petData)
        });

        const data = await res.json();

        dietMorning.value = data.morning || "";
        dietAfternoon.value = data.afternoon || "";
        dietEvening.value = data.evening || "";
        dietWater.value = data.water || "";
        dietNotes.value = data.notes || "";
        
    } catch (err) {
        console.error(err);
        alert("Failed to generate diet plan");
    }
};
</script>

{% endblock %}