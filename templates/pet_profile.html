{% extends "base.html" %}
{% block content %}

<div class="container-fluid py-5 pet-bg">

<!-- ğŸ”™ Back Button -->
<a href="{{ url_for('dashboard') }}" class="back-btn">ğŸ”™</a>


<!-- ğŸ¾ PROFILE IMAGE -->
<div class="text-center mb-3 pet-avatar-wrap">
  {% if pet.photo %}
    <img src="{{ url_for('static', filename='uploads/' + pet.photo) }}"
         class="rounded-circle shadow pet-avatar"
         width="140" height="140">
  {% else %}
    <img src="{{ url_for('static', filename='uploads/default.jpg') }}"
         class="rounded-circle shadow pet-avatar"
         width="140" height="140">
  {% endif %}
  <div class="paw-badge">ğŸ¾</div>
</div>

<!-- ğŸ“¸ IMAGE UPLOAD -->
<form method="POST"
      enctype="multipart/form-data"
      action="{{ url_for('upload_pet_photo', pet_id=pet.id) }}"
      class="text-center mb-4">

  <input type="file" name="photo"
         class="form-control mb-2 w-75 mx-auto"
         accept="image/*" required>

  <button type="submit" class="btn pet-btn-outline btn-sm">
    Upload Pet Photo
  </button>
</form>

<!-- ğŸ¶ PROFILE TITLE -->
<h3 class="text-center pet-title mb-4">
  {{ pet.name }}'s Profile
</h3>

<!-- ğŸ“‡ PROFILE CARD -->
<div class="card pet-card shadow-lg p-4 mx-auto">

  <h4 class="fw-bold text-primary mb-3">{{ pet.name }}</h4>

  <div class="row text-start px-3 pet-info">
    <div class="col-6 mb-2"><strong>Species</strong></div>
    <div class="col-6 mb-2">{{ pet.species }}</div>

    <div class="col-6 mb-2"><strong>Breed</strong></div>
    <div class="col-6 mb-2">{{ pet.breed }}</div>

    <div class="col-6 mb-2"><strong>Age</strong></div>
    <div class="col-6 mb-2">{{ pet.age }} years</div>

    <div class="col-6 mb-2"><strong>Gender</strong></div>
    <div class="col-6 mb-2">{{ pet.gender }}</div>
  </div>

  <!-- ğŸ©º ACTION BUTTONS -->
  <div class="health-buttons mt-4">

    <a href="{{ url_for('add_vaccine', pet_id=pet.id) }}"
       class="health-btn blue">
       ğŸ’‰ Vaccination
    </a>

    <a href="{{ url_for('health_checkup', pet_id=pet.id) }}"
       class="health-btn green">
       ğŸ©º Health Checkup
    </a>

    <a href="{{ url_for('diet_plan', pet_id=pet.id) }}"
       class="health-btn orange">
       ğŸ¥— Diet Plan
    </a>

  </div>
</div>

<!-- ğŸ“œ DETAILS SECTION -->
{% if vaccinations or healths or diets %}
<hr>
<button class="view-btn" onclick="toggleDetails()">
  ğŸ‘ View Above Details
</button>

<div id="detailsSection" style="display:none;">

  {% if vaccinations %}
  <h5 class="fw-bold text-primary mt-3">ğŸ’‰ Vaccination History</h5>
  {% for v in vaccinations %}
    <div class="pet-info-box mb-2">
      <strong>{{ v.vaccine_name }}</strong><br>
      Given: {{ v.last_given_date }}<br>
      Next Due: {{ v.next_due_date }}
    </div>
  {% endfor %}
  {% endif %}

  {% if healths %}
  <h5 class="fw-bold text-success mt-3">ğŸ©º Health Checkup</h5>
  {% for h in healths %}
    <div class="pet-info-box mb-2">
      Date: {{ h.checkup_date }}<br>
      Notes: {{ h.notes }}
    </div>
  {% endfor %}
  {% endif %}

  {% if diets %}
  <h5 class="fw-bold text-warning mt-3">ğŸ¥— Diet Plan</h5>
  {% for d in diets %}
    <div class="pet-info-box mb-2">
      Food: {{ d.food_name }}<br>
      Quantity: {{ d.quantity }}
    </div>
  {% endfor %}
  {% endif %}

</div>

{% else %}
<p class="text-center text-muted mt-3">
  No health records yet.
</p>
{% endif %}

<!-- ğŸ”™ BACK TO DASHBOARD -->
<div class="text-center">
  <a href="{{ url_for('dashboard') }}"
     class="btn pet-btn mt-4">
    â† Back to Dashboard
  </a>
</div>

<!-- ğŸ¾ FOOTER -->
<div class="text-center mt-4 pet-footer">
  <img src="{{ url_for('static', filename='images/s5.jpeg') }}"
       width="170" class="rounded shadow-sm">
  <p class="small text-muted mt-2">
    Your pet, your responsibility ğŸ¾
  </p>
</div>

</div>

<!-- ğŸ§  JS -->
<script>
function toggleDetails() {
  const section = document.getElementById("detailsSection");
  section.style.display =
    section.style.display === "none" ? "block" : "none";
}
</script>

<!-- ğŸ¨ CSS -->
<style>
.pet-bg {
  min-height: 100vh;
  background: linear-gradient(to bottom, #f5f9ff, #eef4fb);
}
.pet-avatar-wrap { position: relative; display: inline-block; }
.pet-avatar { object-fit: cover; border: 4px solid #dbe7f6; background: white; }
.pet-title { color: #325ea8; font-weight: 600; }
.pet-card {
  max-width: 470px;
  border-radius: 18px;
  background: linear-gradient(180deg, #ffffff, #f7fbff);
}
.pet-info-box {
  background: #f4f7fc;
  padding: 12px;
  border-radius: 12px;
}
.view-btn {
  width: 100%;
  background: #1a73e8;
  color: #fff;
  border: none;
  padding: 12px;
  border-radius: 14px;
  font-weight: 700;
  margin-top: 15px;
}
.view-btn:active { transform: scale(0.96); }

.back-btn {
  position: fixed;
  top: 65px;
  left: 18px;
  font-size: 28px;
  color: #233b6c;
}
</style>

{% endblock %}
